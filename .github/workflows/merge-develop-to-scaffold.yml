name: Merge Develop to Scaffold Branch

on:
  push:
    branches:
      - develop
      - remove-scaffold

jobs:
  merge-develop-to-scaffold:
    name: merge develop to scaffold
    runs-on: ubuntu-latest

    steps:
      - name: Merge develop to scaffold
        shell: bash
        env:
          TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          git config --global user.name "$GITHUB_ACTOR"
          git config --global user.email "$GITHUB_ACTOR@users.noreply.github.com"

          echo "Cloning alleyinteractive/create-wordpress-plugin..."
          git clone --recursive --quiet https://$TOKEN@github.com/alleyinteractive/create-wordpress-plugin.git create-wordpress-plugin

          git fetch origin develop
          git fetch origin scaffold

          git checkout scaffold
          git merge origin/develop --no-edit
          git push -u origin scaffold
